{"type": "fact", "content": "The application uses a stream-based, incremental message handling architecture.", "metadata": {"confidence": 1.0, "tags": ["architecture", "react", "state-management"], "source": "refactoring-session"}, "timestamp": "2023-10-27T10:00:00Z"}
{"type": "fact", "content": "Assistant messages (text, tool_use, permission) are created dynamically in `activeMessages` as they arrive from the AI's response stream.", "metadata": {"confidence": 1.0, "tags": ["architecture", "react", "state-management"], "source": "refactoring-session"}, "timestamp": "2023-10-27T10:01:00Z"}
{"type": "skill", "content": "To correctly handle the message lifecycle, use the `finalizeMessageById` function to move a message from `activeMessages` to `frozenMessages` as soon as its content stream is complete. This applies to user messages, AI text responses, and permission/tool messages.", "metadata": {"confidence": 1.0, "tags": ["architecture", "react", "state-management", "workflow"], "source": "refactoring-session"}, "timestamp": "2023-10-27T10:02:00Z"}
{"type": "fact", "content": "The concept of a single, static `assistantPlaceholder` has been deprecated and removed. All assistant messages are created and managed dynamically.", "metadata": {"confidence": 1.0, "tags": ["architecture", "react", "state-management", "legacy"], "source": "refactoring-session"}, "timestamp": "2023-10-27T10:03:00Z"}
{"type": "fact", "content": "All message types (user, assistant, system, permission) are treated as equal, independent events in the stream to ensure they are rendered and finalized in the correct chronological order.", "metadata": {"confidence": 1.0, "tags": ["architecture", "react", "state-management"], "source": "refactoring-session"}, "timestamp": "2023-10-27T10:04:00Z"}
{"type": "skill", "content": "When debugging rendering issues, check the order of messages in the `activeMessages` array first. The UI is a direct reflection of this array's state. For message lifecycle issues, inspect the calls to `finalizeMessageById`.", "metadata": {"confidence": 1.0, "tags": ["debugging", "react", "state-management"], "source": "refactoring-session"}, "timestamp": "2023-10-27T10:05:00Z"}
